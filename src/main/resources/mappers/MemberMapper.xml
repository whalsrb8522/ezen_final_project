<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.myweb.www.repository.MemberDAO">
	<select id="getMember"
		resultType="com.myweb.www.domain.MemberVO">
		select * from member where m_mail=#{m_mail}
	</select>

	<insert id="insertMember">
		insert into member(m_mail, m_pw, m_nick_name, m_introduct, m_address)
		values(#{m_mail}, #{m_pw}, #{m_nick_name}, #{m_introduct},
		#{m_address})
	</insert>

	<select id="nicknameCheck" resultType="int">
		select count(*) from member where m_nick_name = #{m_nick_name}
	</select>

	<select id="getNewMember" parameterType="string"
		resultType="com.myweb.www.domain.MemberVO">
		SELECT *
		FROM Member
		WHERE m_mail = #{m_mail}
		ORDER BY m_number DESC
		LIMIT 1
	</select>
	
	<update id="updateMember" parameterType="com.myweb.www.domain.MemberDTO">
        UPDATE member SET
        m_pw = #{mvo.m_pw},
        m_nick_name = #{mvo.m_nick_name},
        m_introduct = #{mvo.m_introduct},
        m_address = #{mvo.m_address}
        WHERE m_number = #{mvo.m_number}

        <if test="mivo != null">
            UPDATE member_image SET
            mi_name = #{mivo.mi_name}
            WHERE m_number = #{mvo.m_number}
        </if>
    </update>

	

	<!-- 채팅 -->
	<select id="selectMemberWithNumber"
		resultType="com.myweb.www.domain.MemberVO">
		select * from member where m_number = #{m_number}
	</select>

</mapper>
